<form
  [formGroup]="employeeForm()"
  (ngSubmit)="submitForm()"
  class="space-y-6"
>

  <!-- Required Information -->
  <div class="card bg-base-200 shadow-sm border-l-4 border-l-primary">
    <div class="card-body p-4">
      <h3 class="card-title text-lg font-semibold mb-4">
        <shared-icon type="user" />
        Required Information
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Position -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Position *</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('position')?.value }}
          </div>
          } @else {
          <input
            type="text"
            formControlName="position"
            placeholder="Enter position"
            class="input input-bordered w-full"
            [class.input-error]="employeeForm().get('position')?.invalid && employeeForm().get('position')?.touched"
          />
          @if (employeeForm().get('position')?.invalid && employeeForm().get('position')?.touched) {
          <label class="label">
            <span class="label-text-alt text-error">Position is required</span>
          </label>
          }
          }
        </div>

        <!-- Hire Date -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Hire Date *</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('hireDate')?.value }}
          </div>
          } @else {
          <input
            type="date"
            formControlName="hireDate"
            class="input input-bordered w-full"
            [class.input-error]="employeeForm().get('hireDate')?.invalid && employeeForm().get('hireDate')?.touched"
          />
          @if (employeeForm().get('hireDate')?.invalid && employeeForm().get('hireDate')?.touched) {
          <label class="label">
            <span class="label-text-alt text-error">Hire date is required</span>
          </label>
          }
          }
        </div>

        <!-- Status -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Status *</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ getEmployeeStatusDisplayName(employeeForm().get('status')?.value) }}
          </div>
          } @else {
          <select
            formControlName="status"
            class="select select-bordered w-full"
            [class.select-error]="employeeForm().get('status')?.invalid && employeeForm().get('status')?.touched"
          >
            @for (status of employeeStatuses(); track status.id) {
            <option [value]="status.code">
              {{ status.name }}
            </option>
            }
          </select>
          @if (employeeForm().get('status')?.invalid && employeeForm().get('status')?.touched) {
          <label class="label">
            <span class="label-text-alt text-error">Status is required</span>
          </label>
          }
          }
        </div>

        <!-- Salary -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Salary *</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            @if (employeeForm().get('salary')?.value) {
            {{ employeeForm().get('salary')?.value | currency:(employeeForm().get('currency')?.value || 'USD') }}
            } @else {
            -
            }
          </div>
          } @else {
          <div class="relative">
            <input
              type="number"
              formControlName="salary"
              placeholder="Enter salary"
              class="input input-bordered w-full pr-12"
              [class.input-error]="employeeForm().get('salary')?.invalid && employeeForm().get('salary')?.touched"
              step="0.01"
              min="0.01"
            />
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <span class="text-gray-500 text-sm">
                {{ getCurrencySymbol(employeeForm().get('currency')?.value || 'USD') }}
              </span>
            </div>
          </div>
          @if (employeeForm().get('salary')?.invalid && employeeForm().get('salary')?.touched) {
          <label class="label">
            <span class="label-text-alt text-error">Salary is required and must be greater than 0</span>
          </label>
          }
          @if (employeeForm().get('salary')?.value) {
          <div class="text-xs text-gray-500 mt-1">
            Formatted: {{ employeeForm().get('salary')?.value | currency:(employeeForm().get('currency')?.value ||
            'USD') }}
          </div>
          }
          }
        </div>

        <!-- Currency -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Currency *</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ getCurrencyDisplayName(employeeForm().get('currency')?.value) }}
          </div>
          } @else {
          <select
            formControlName="currency"
            class="select select-bordered w-full"
            [class.select-error]="employeeForm().get('currency')?.invalid && employeeForm().get('currency')?.touched"
          >
            @for (currency of currencies(); track currency.id) {
            <option [value]="currency.code">
              {{ currency.code }} - {{ currency.name }}
            </option>
            }
          </select>
          @if (employeeForm().get('currency')?.invalid && employeeForm().get('currency')?.touched) {
          <label class="label">
            <span class="label-text-alt text-error">Currency is required</span>
          </label>
          }
          }
        </div>

        <!-- Salary Type -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Salary Type *</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ getSalaryTypeDisplayName(employeeForm().get('salaryType')?.value) }}
          </div>
          } @else {
          <select
            formControlName="salaryType"
            class="select select-bordered w-full"
            [class.select-error]="employeeForm().get('salaryType')?.invalid && employeeForm().get('salaryType')?.touched"
          >
            <option value="">Select type</option>
            @for (type of salaryTypes(); track type.id) {
            <option [value]="type.code">
              {{ type.name }}
            </option>
            }
          </select>
          @if (employeeForm().get('salaryType')?.invalid && employeeForm().get('salaryType')?.touched) {
          <label class="label">
            <span class="label-text-alt text-error">Salary type is required</span>
          </label>
          }
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Employment Details -->
  <div class="card bg-base-200 shadow-sm">
    <div class="card-body p-4">
      <h3 class="card-title text-lg font-semibold mb-4">
        <shared-icon type="building" />
        Employment Details
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Department -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Department</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ getDepartmentDisplayName(employeeForm().get('department')?.value) }}
          </div>
          } @else {
          <select
            formControlName="department"
            class="select select-bordered w-full"
          >
            <option value="">Select department</option>
            @for (dept of departments(); track dept.id) {
            <option
              [value]="dept.code"
              [title]="dept.description"
            >
              {{ dept.name }}
            </option>
            }
          </select>
          }
        </div>

        <!-- Employment Type -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Employment Type</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ getEmploymentTypeDisplayName(employeeForm().get('employmentType')?.value) }}
          </div>
          } @else {
          <select
            formControlName="employmentType"
            class="select select-bordered w-full"
          >
            <option value="">Select type</option>
            @for (type of employmentTypes(); track type.id) {
            <option [value]="type.code">
              {{ type.name }}
            </option>
            }
          </select>
          }
        </div>

        <!-- Job Level -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Job Level</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ getJobLevelDisplayName(employeeForm().get('jobLevel')?.value) }}
          </div>
          } @else {
          <select
            formControlName="jobLevel"
            class="select select-bordered w-full"
          >
            <option value="">Select level</option>
            @for (level of jobLevels(); track level.id) {
            <option [value]="level.code">
              {{ level.name }}
            </option>
            }
          </select>
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Important Dates -->
  <div class="card bg-base-200 shadow-sm">
    <div class="card-body p-4">
      <h3 class="card-title text-lg font-semibold mb-4">
        <shared-icon type="calendar" />
        Important Dates
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Termination Date -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Termination Date</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('terminationDate')?.value }}
          </div>
          } @else {
          <input
            type="date"
            formControlName="terminationDate"
            class="input input-bordered w-full"
          />
          }
        </div>

        <!-- Probation End Date -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Probation End Date</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('probationEndDate')?.value }}
          </div>
          } @else {
          <input
            type="date"
            formControlName="probationEndDate"
            class="input input-bordered w-full"
          />
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Compensation -->
  <div class="card bg-base-200 shadow-sm">
    <div class="card-body p-4">
      <h3 class="card-title text-lg font-semibold mb-4">
        <shared-icon type="helmet-safety" />
        Compensation
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Salary -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Salary</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            @if (employeeForm().get('salary')?.value) {
            {{ employeeForm().get('salary')?.value | currency:(employeeForm().get('currency')?.value || 'USD') }}
            } @else {
            -
            }
          </div>
          } @else {
          <div class="relative">
            <input
              type="number"
              formControlName="salary"
              placeholder="Enter salary"
              class="input input-bordered w-full pr-12"
              step="0.01"
              min="0"
            />
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <span class="text-gray-500 text-sm">
                {{ getCurrencySymbol(employeeForm().get('currency')?.value || 'USD') }}
              </span>
            </div>
          </div>
          @if (employeeForm().get('salary')?.value) {
          <div class="text-xs text-gray-500 mt-1">
            Formatted: {{ employeeForm().get('salary')?.value | currency:(employeeForm().get('currency')?.value ||
            'USD') }}
          </div>
          }
          }
        </div>

        <!-- Currency -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Currency</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ getCurrencyDisplayName(employeeForm().get('currency')?.value) }}
          </div>
          } @else {
          <select
            formControlName="currency"
            class="select select-bordered w-full"
          >
            @for (currency of currencies(); track currency.id) {
            <option [value]="currency.code">
              {{ currency.code }} - {{ currency.name }}
            </option>
            }
          </select>
          }
        </div>

        <!-- Salary Type -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Salary Type</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ getSalaryTypeDisplayName(employeeForm().get('salaryType')?.value) }}
          </div>
          } @else {
          <select
            formControlName="salaryType"
            class="select select-bordered w-full"
          >
            <option value="">Select type</option>
            @for (type of salaryTypes(); track type.id) {
            <option [value]="type.code">
              {{ type.name }}
            </option>
            }
          </select>
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Work Information -->
  <div class="card bg-base-200 shadow-sm">
    <div class="card-body p-4">
      <h3 class="card-title text-lg font-semibold mb-4">
        <shared-icon type="building" />
        Employment Information
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Work Email -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Work Email</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('workEmail')?.value || '-' }}
          </div>
          } @else {
          <input
            type="email"
            formControlName="workEmail"
            placeholder="Enter work email"
            class="input input-bordered w-full"
            [class.input-error]="employeeForm().get('workEmail')?.invalid && employeeForm().get('workEmail')?.touched"
          />
          @if (employeeForm().get('workEmail')?.invalid && employeeForm().get('workEmail')?.touched) {
          <label class="label">
            <span class="label-text-alt text-error">Please enter a valid email</span>
          </label>
          }
          }
        </div>

        <!-- Work Phone -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Work Phone</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('workPhone')?.value || '-' }}
          </div>
          } @else {
          <input
            type="tel"
            formControlName="workPhone"
            placeholder="Enter work phone"
            class="input input-bordered w-full"
          />
          }
        </div>

        <!-- Work Location -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Work Location</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('workLocation')?.value || '-' }}
          </div>
          } @else {
          <input
            type="text"
            formControlName="workLocation"
            placeholder="Enter work location"
            class="input input-bordered w-full"
          />
          }
        </div>

        <!-- Work Schedule -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Work Schedule</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('workSchedule')?.value || '-' }}
          </div>
          } @else {
          <input
            type="text"
            formControlName="workSchedule"
            placeholder="Enter work schedule"
            class="input input-bordered w-full"
          />
          }
        </div>

        <!-- Cost Center -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Cost Center</span>
          </label>
          @if (isReadOnly()) {
          <div class="input input-bordered w-full bg-base-200 text-base-content/70">
            {{ employeeForm().get('costCenter')?.value || '-' }}
          </div>
          } @else {
          <input
            type="text"
            formControlName="costCenter"
            placeholder="Enter cost center"
            class="input input-bordered w-full"
          />
          }
        </div>
      </div>
    </div>
  </div>

  <!-- Additional Information -->
  <div class="card bg-base-200 shadow-sm">
    <div class="card-body p-4">
      <h3 class="card-title text-lg font-semibold mb-4">
        <shared-icon type="info" />
        Account Information
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Skills -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Skills</span>
          </label>
          @if (isReadOnly()) {
          <div class="textarea textarea-bordered w-full bg-base-200 text-base-content/70 min-h-[4.5rem]">
            {{ employeeForm().get('skills')?.value || '-' }}
          </div>
          } @else {
          <textarea
            formControlName="skills"
            placeholder="Enter skills"
            class="textarea textarea-bordered w-full"
            rows="3"
          ></textarea>
          }
        </div>

        <!-- Certifications -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Certifications</span>
          </label>
          @if (isReadOnly()) {
          <div class="textarea textarea-bordered w-full bg-base-200 text-base-content/70 min-h-[4.5rem]">
            {{ employeeForm().get('certifications')?.value || '-' }}
          </div>
          } @else {
          <textarea
            formControlName="certifications"
            placeholder="Enter certifications"
            class="textarea textarea-bordered w-full"
            rows="3"
          ></textarea>
          }
        </div>

        <!-- Education -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Education</span>
          </label>
          @if (isReadOnly()) {
          <div class="textarea textarea-bordered w-full bg-base-200 text-base-content/70 min-h-[4.5rem]">
            {{ employeeForm().get('education')?.value || '-' }}
          </div>
          } @else {
          <textarea
            formControlName="education"
            placeholder="Enter education"
            class="textarea textarea-bordered w-full"
            rows="3"
          ></textarea>
          }
        </div>

        <!-- Benefits -->
        <div class="form-control">
          <label class="label">
            <span class="label-text font-medium">Benefits</span>
          </label>
          @if (isReadOnly()) {
          <div class="textarea textarea-bordered w-full bg-base-200 text-base-content/70 min-h-[4.5rem]">
            {{ employeeForm().get('benefits')?.value || '-' }}
          </div>
          } @else {
          <textarea
            formControlName="benefits"
            placeholder="Enter benefits"
            class="textarea textarea-bordered w-full"
            rows="3"
          ></textarea>
          }
        </div>
      </div>

      <!-- Notes -->
      <div class="form-control mt-4">
        <label class="label">
          <span class="label-text font-medium">Notes</span>
        </label>
        @if (isReadOnly()) {
        <div class="textarea textarea-bordered w-full bg-base-200 text-base-content/70 min-h-[4.5rem]">
          {{ employeeForm().get('notes')?.value || '-' }}
        </div>
        } @else {
        <textarea
          formControlName="notes"
          placeholder="Enter additional notes"
          class="textarea textarea-bordered w-full"
          rows="3"
        ></textarea>
        }
      </div>
    </div>
  </div>

  <!-- Submit Button -->
  @if (!isReadOnly()) {
  <div class="flex justify-end gap-2">
    <button
      type="button"
      class="btn btn-outline"
      (click)="cancelForm()"
      [disabled]="isLoading()"
    >
      Cancel
    </button>
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="employeeForm().invalid || isLoading()"
    >
      @if (isLoading()) {
      <shared-loading></shared-loading>
      } @else {
      <shared-icon type="save" />
      }
      {{ isEditMode() ? 'Update' : 'Create' }} Employee
    </button>
  </div>
  }

</form>
